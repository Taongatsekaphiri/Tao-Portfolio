<%- include('partials/header', { page: 'contact', pageStyles }) %>


<a href="javascript:history.back()" class="back-btn">← Back</a>

<div class="contact-page">
  <!-- Left Section -->
  <div class="contact-left">
    <h1><%= contact.title %></h1>
    <p><%= contact.subtitle %></p>

    <ul class="contact-info">
      <li>Email: <a href="mailto:<%= contact.email %>"><%= contact.email %></a></li>
      <li>Phone: <a href="tel:<%= contact.phone %>"><%= contact.phone %></a></li>
      <li>Location: <%= contact.location %></li>
    </ul>

    <div class="social-links">
      <span>Follow Me:</span>
      <a href="<%= contact.github %>" target="_blank">GitHub</a>
      <a href="<%= contact.linkedin %>" target="_blank">LinkedIn</a>
    </div>
  </div>

  <!-- Right Section / Contact Form -->
  <div class="contact-right">
    <div class="form-card">
      <h2>Send a Message</h2>
      <form id="contactForm" class="contact-form" action="/contact" method="POST">
        <div class="form-group">
          <input type="text" name="name" placeholder=" " required>
          <label>Full Name</label>
        </div>

        <div class="form-group">
          <input type="email" name="email" placeholder=" " required>
          <label>Email</label>
        </div>

        <div class="form-group">
          <textarea name="message" placeholder=" " required></textarea>
          <label>Your Message</label>
        </div>

        <button type="submit" class="submit-btn">Send</button>
      </form>

      <div id="formMessage" class="success-msg" style="display: none; flex-direction: column; align-items: center; gap: 10px;">
        <svg width="50" height="50" viewBox="0 0 24 24">
          <path fill="none" stroke="#10b981" stroke-width="3" d="M4 12l6 6L20 6"/>
        </svg>
        <span>Message sent successfully! I will get back to you soon.</span>
        <button id="sendAnother" class="submit-btn" style="margin-top: 10px;">Send Another Message</button>
      </div>
    </div>
  </div>
</div>

<footer>
  © Taonga Tseka Phiri <%= new Date().getFullYear() %> | Crafted with Precision
</footer>

<script>
// AJAX for contact form submission
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('contactForm');
  const formMessage = document.getElementById('formMessage');
  const sendAnother = document.getElementById('sendAnother');

  form.addEventListener('submit', (e) => {
    e.preventDefault();

    const data = {
      name: form.name.value,
      email: form.email.value,
      message: form.message.value
    };

    fetch('/contact', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(result => {
      if (result.status === 'success') {
        form.style.display = 'none';
        formMessage.style.display = 'flex';
      } else {
        alert("Error: " + result.details);
      }
    })
    .catch(err => console.error(err));
  });

  sendAnother.addEventListener('click', () => {
    form.reset();
    form.style.display = 'block';
    formMessage.style.display = 'none';
  });
});
</script>
